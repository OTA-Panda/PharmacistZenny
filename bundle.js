!function(e){var l={};function o(t){if(l[t])return l[t].exports;var r=l[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=l,o.d=function(e,l,t){o.o(e,l)||Object.defineProperty(e,l,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,l){if(1&l&&(e=o(e)),8&l)return e;if(4&l&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&l&&"string"!=typeof e)for(var r in e)o.d(t,r,function(l){return e[l]}.bind(null,r));return t},o.n=function(e){var l=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(l,"a",l),l},o.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)},o.p="",o(o.s=0)}([function(e,l){const o=document.getElementById("zenny"),t=o.getContext("2d");t.scale(20,20),bottleCreate=((e,l)=>{const o=[];for(;l--;)o.push(new Array(e).fill(0));return o});const r=bottleCreate(8,16);console.log(r),console.table(r);const n=3,c=3,a=3,i=0;bottleNew=(()=>{r.forEach(e=>e.fill(0)),p.score=0,playerScore()}),bottleClearSection=(e=>{for(let l=0;l<e.length;l++){const o=e[l][0],t=e[l][1];r[t][o]=0,p.score+=10}}),bottleCheck=(()=>{let e=1,l=[];for(let o=0;o<r[0].length;++o){let t=[];for(let n=r.length-1;n>0;--n)r[n][o]&&r[n+1]&&r[n][o]===r[n+1][o]?(1===e&&t.push([o,n+1]),e++,console.log(e),t.push([o,n])):(e>3&&(console.log("4 chain!"),console.log(t),l=l.concat(t),console.log(l)),e=1,t=[]),0===n&&e>3&&(console.log("4 chain!"),console.log(t),l=l.concat(t))}for(let o=r.length-1;o>0;--o){let t=[];for(let n=0;n<r[o].length;++n)r[o][n]&&r[o][n-1]&&r[o][n]===r[o][n-1]?(1===e&&t.push([n-1,o]),e++,t.push([n,o])):(e>3&&(console.log("4 chain!"),console.log(t),l=l.concat(t)),e=1,t=[]),n===r[o].length-1&&e>3&&(console.log("4 chain!"),console.log(t),l=l.concat(t))}bottleClearSection(l)}),pillColor=(()=>{const e=["red","yellow","blue"];return e[Math.random()*e.length|0]}),pillCreate=(()=>{return[[pillColor(),0],[pillColor(),0]]});const p={pos:{x:a,y:i},pill:pillCreate(),score:0};draw=(()=>{t.fillStyle="#000",t.fillRect(0,0,o.width,o.height),t.fillStyle="#55f",t.fillRect(0+n,0+c,8,16),t.fillStyle="#55f",t.fillRect(a+n,i+c-1,2,1),drawMatrix(r,{x:0,y:0}),drawMatrix(p.pill,p.pos)}),drawMatrix=((e,l)=>{e.forEach((e,o)=>{e.forEach((e,r)=>{0!==e&&(t.fillStyle=e,t.fillRect(r+l.x+n,o+l.y+c,1,1))})})}),_merge=((e,l)=>{l.pill.forEach((o,t)=>{o.forEach((o,r)=>{0!==o&&(e[t+l.pos.y][r+l.pos.x]=o)})})}),_collide=((e,l)=>{const[o,t]=[l.pill,l.pos];for(let l=0;l<o.length;++l)for(let r=0;r<o[l].length;++r)if(0!==o[l][r]&&0!==(e[l+t.y]&&e[l+t.y][r+t.x]))return!0;return!1});let s=0,f=0;pillNew=(()=>{p.pill=pillCreate(),p.pos={x:a,y:i},_collide(r,p)&&bottleNew()}),pillDrop=(()=>{p.pos.y++,_collide(r,p)&&(p.pos.y--,_merge(r,p),bottleCheck(r),pillNew(),playerScore()),s=0}),gameLoop=((e=0)=>{const l=e-f;f=e,(s+=l)>500&&pillDrop(),draw(),requestAnimationFrame(gameLoop)}),playerMove=(e=>{p.pos.x+=e,_collide(r,p)&&(p.pos.x-=e)}),pillRotate=((e,l)=>{for(let l=0;l<e.length;++l)for(let o=0;o<l;++o)[e[o][l],e[l][o]]=[e[l][o],e[o][l]];l>0?e.forEach(e=>e.reverse()):e.reverse()}),playerRotate=(e=>{const l=p.pos.x;let o=-1;for(pillRotate(p.pill,e);_collide(r,p);)if(p.pos.x+=o,(o=-(o+(o>0?1:-1)))>p.pill[0].length)return pillRotate(p.pill,-e),void(p.pos.x=l)}),playerScore=(()=>{document.getElementById("score").innerText=p.score}),document.addEventListener("keydown",e=>{switch(e.code){case"ArrowLeft":playerMove(-1);break;case"ArrowRight":playerMove(1);break;case"ArrowDown":pillDrop();break;case"KeyD":playerRotate(-1);break;case"KeyF":playerRotate(1)}}),playerScore(),gameLoop()}]);
//# sourceMappingURL=bundle.js.map